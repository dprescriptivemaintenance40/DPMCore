<p-toast position="top-right"></p-toast>
<p-card>
    <div *ngIf="prescriptiveTree" class="col-md-12" style="overflow: scroll;">
        <button *ngIf="FinalUpdate" label="Back" type="button" class="btn btn-dark" style="margin-left: 70px" data-toggle="modal" data-target="#treeModal">Update</button> <br><br>
        <button *ngIf="AddFailureMode" type="button" class="btn btn-secondary" (click)="AddFailureModeToTree()" pTooltip="If you Want to Update the tree Click this Button" tooltipPosition="top"><i class="pi pi-plus"></i> Failure Mode</button>
        <p-organizationChart [value]="data1" (onNodeSelect)="onNodeSelect($event)" styleClass="company">
            <ng-template let-node pTemplate="person">
                <div class="node-header p-corner-top">
                    {{node.label}}
                    <a class="edit-org-bttn" *ngIf="node.edit !== undefined && node.edit" (click)="SelectNodeToUpdate(node)" pTooltip="Edit Node" tooltipPosition="top"><i class="pi pi-pencil"></i></a>
                    <a class="delete-org-bttn" *ngIf="node.delete !== undefined && node.delete" (click)="SelectNodeToDelete(node)" data-toggle="modal" data-target="#DeleteFailureMode" pTooltip="Delete Node" tooltipPosition="top"><i class="pi pi-times"></i></a>
                    <a class="viewFCA-org-bttn" pTooltip="Select Node To view and edit" tooltipPosition="top" *ngIf="node.viewFCA !== undefined && node.viewFCA" (click)="SelectNodeToView(node)"><i class="fa fa-eye" aria-hidden="true"></i></a>
                </div>
                <div class="node-content">
                    <div class="a">{{node.data.name}}</div>
                </div>
            </ng-template>
            <ng-template let-node pTemplate="department">
                {{node.label}}
            </ng-template>
        </p-organizationChart>
    </div>
</p-card>

<div id="ScrollUpdateTree5" class="modal fade" id="treeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Tree Update</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>
            <div class="modal-body">
                Are you sure you want to Update the tree
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="UpdateChanges()">Save changes</button>
            </div>
        </div>
    </div>
</div>

<div class="modal update" id="FunctionUpdate" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Update Function</h5>
                <button type="button" class="close" data-dismiss="update" aria-label="Close" (click)="closeFunctionmodal()">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <form>
                        <div class="form-group">
                            <label for="recipient-name" class="col-form-label">Fluid Type:</label>
                            <input type="text" name='FluidType' [(ngModel)]="FluidType" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Rated Head : </label>
                            <input type="text" name='RatedHead' [(ngModel)]="RatedHead" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="message-text" class="col-form-label">Days: </label>
                            <input type="text" name='PeriodType' [(ngModel)]="PeriodType" class="form-control">
                        </div>
                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="update" (click)="closeFunctionmodal()">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="update" (click)="SaveFunction()">Save changes</button>
            </div>
        </div>
    </div>
</div>



<div class="FailureModeUpdate modal" id="FailureModeUpdate" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" style="margin-left: 5px;">Add Failure Mode Tree </h5><br>
                <small class="form-text text-muted" style="margin-top: 25px; float: left;">Note : Add Single Failure Mode at a time</small>
                <button type="button" class="close" data-dismiss="FailureModeUpdate" aria-label="Close" (click)="closeFMmodal()">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="FailureModeUpdate modal-body">
                <div class="container-fluid">
                    <div class="container">
                        <div *ngFor="let func of failuerMode" class="border" pDraggable="func" (onDragStart)="dragStart1($event,func)" (onDragEnd)="dragEnd1($event)">
                            {{func.Description}}
                        </div>
                        <div class="drop" pDroppable="func" (onDrop)="drop1($event)">
                            <div *ngFor="let c of dropedMode" class="row">
                                <div style="word-wrap: break-word;float:left;">{{c?.Description}}</div>
                                <div style="float:right; margin-left: 5px;">
                                    <a class="cell-icon-button cdk-close" style="color: black;" (click)="FailureModeDropped(c)" pTooltip="Delete" tooltipPosition="top">
                                        <i class="far fa-times-circle "></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                        <small class="form-text text-muted">Drag and Drop here, from above List </small>

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="FailureModeUpdate" (click)="closeFMmodal()">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="FailureModeUpdate" (click)="ADDSingleFailureModeToTree()">Save changes</button>
            </div>
        </div>
    </div>
</div>


<div class="LSEffectUpdate modal" id="LSEffectUpdate" tabindex="-1" role="dialog" style="overflow: scroll;">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h6 class="modal-title">Add Local and System Effect for {{LSFailureMode}} </h6><br>
                <button type="button" class="close" data-dismiss="LSEffectUpdate" aria-label="Close" (click)="closeLSmodal()">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>
            <div class="LSEffectUpdate modal-body">
                <div class="container-fluid">
                    <div class="container">
                        <div class="p-fluid">
                            <div>
                                <label>Local Effect</label>
                                <input type="text" class="form-control" [(ngModel)]="failuerModeLocalEffects" placeholder="Type Local Effect" required>
                            </div>
                            <div>
                                <label>System Effect</label>
                                <input type="text" class="form-control" [(ngModel)]="failuerModeSystemEffects" placeholder="Type System Effect" required>
                            </div>
                            <div style="margin-top: 20px;">
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="input-group mb-3">
                                            <div class="input-group-prepend">
                                                <span class="input-group-text" id="uploadAttachments">Upload</span>
                                            </div>
                                            <div class="custom-file">
                                                <input type="file" accept="image/x-png,image/jpeg,.pdf," (change)="uploadAttachmentFile($event)" class="custom-file-input" id="uploadAttachments" aria-describedby="uploadAttachments">
                                                <label class="custom-file-label" *ngIf="fileUpload == ''" for="inputGroupFile01">Attachment</label>
                                                <label class="custom-file-label" *ngIf="fileUpload != ''" for="inputGroupFile01">{{fileUpload}}</label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="input-group mb-3">
                                            <textarea class="form-control custom-textarea" [(ngModel)]="Remark" id="message" name="body" rows="3" placeholder="Add Remark Here"></textarea>
                                        </div>

                                    </div>

                                    <br>
                                    <div class="container">
                                        <div class="row">
                                            <div class="col-md-8">
                                                <h6> Down Time Factor (Range 1 - 10): {{ADDDownTimeFactor}}</h6>
                                            </div>
                                            <div Style="margin-top:8px;" class="col-md-3">
                                                <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="ADDDownTimeFactor" [min]="1" [max]="10"></p-slider>
                                            </div>
                                        </div>
                                        <br>
                                        <div class="row">
                                            <div class="col-md-8">
                                                <h6> Scrape Factor (Range 1 - 5): {{ADDScrapeFactor}}</h6>
                                            </div>
                                            <div Style="margin-top:8px;" class="col-md-3">
                                                <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="ADDScrapeFactor" [min]="1" [max]="5"></p-slider>
                                            </div>
                                        </div>

                                        <br>

                                        <div class="row">
                                            <div class="col-md-8">
                                                <h6> Safety Factor (Range 1 - 20): {{ADDSafetyFactor}}</h6>
                                            </div>
                                            <div Style="margin-top:8px;" class="col-md-3">
                                                <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="ADDSafetyFactor" [min]="1" [max]="20"></p-slider>
                                            </div>
                                        </div>

                                        <br>
                                        <div class="row">
                                            <div class="col-md-8">
                                                <h6>Protection Factor (Range 1 - 10): {{ADDProtectionFactor}}</h6>
                                            </div>
                                            <div Style="margin-top:8px;" class="col-md-3">
                                                <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="ADDProtectionFactor" [min]="1" [max]="10"></p-slider>
                                            </div>
                                        </div>

                                        <br>

                                        <div class="row">
                                            <div class="col-md-8">
                                                <h6>Frequency Factor (Range 1 - 15): {{ADDFrequencyFactor}}</h6>
                                            </div>
                                            <div Style="margin-top:8px;" class="col-md-3">
                                                <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="ADDFrequencyFactor" [min]="1" [max]="15"></p-slider>
                                            </div>
                                        </div>
                                        <br>
                                    </div>
                                </div>
                            </div>
                            <!-- <div>
                                <button label="Next" style="margin: 20px" type="button" class="btn btn-dark" data-toggle="modal" data-target="#AttachmentModalAdd"> <i class="fa fa-paperclip" aria-hidden="true"></i></button>
                                <button label="Next" style="margin: 20px" type="button" class="btn btn-dark" data-toggle="modal" data-target="#CommentModalAdd"> <i class="fa fa-comment" aria-hidden="true"></i></button>
                            </div> -->
                        </div>
                    </div>
                    <br>
                </div>
            </div>
            <div class="LSEffectUpdate modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="LSEffectUpdate" (click)="closeLSmodal()">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="LSEffectUpdate" (click)="LSEffectToTree()">Save changes</button>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="AttachmentModalAdd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span>
                    Add Attachment for {{LSFailureMode}}
                </span>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close" (click)="CloseAttachmentModalAdd()" pTooltip="Add Attachments" tooltipPosition="top">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-11 ml-auto">
                        <div class="toolbar" role="toolbar">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Upload</span>
                                </div>
                                <div class="custom-file">
                                    <input [disabled]="FMAttachmentADD" type="file" accept="image/x-png,image/jpeg,.pdf," (change)="AddUploadAttachmentFile($event)" class="custom-file-input" id="inputGroupFile01">
                                    <label class="custom-file-label" for="inputGroupFile01">Choose attachment</label>
                                </div>
                            </div>
                        </div>
                        <div style="border-color: black;height: 300px;width: 400px;" class="card">
                            <div class="file"><br>
                                <span *ngIf="(ADDdbPathURL == '')">
                                    <p style="margin: 20px; margin-left: 40px;">Please select attachment</p>
                                </span>
                                <span style="margin: 10px;" *ngIf="extensionAddPDF">
                                <iframe [src]="ADDdbPathURL" width="350" height="250" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px;" allowfullscreen> </iframe>
 
                               <a class="attachment"  data-toggle="modal" data-target="#DeleteFailureModeAttachment"><i class="pi pi-times"></i></a>  
                             </span>
                                <span style="margin: 10px;" *ngIf="extensionAddImage">
                                <img [src]="ADDdbPathURL" width="350" height="250"> 
                             
                               <a class="attachment" (click)="DeleteADDAttachment()"><i class="pi pi-times"></i></a>  
                             </span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="AttachmentDoneModal()">Done</button>
            </div>


        </div>
    </div>
</div>

<div class="modal fade" id="CommentModalAdd" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <span>
                    Add Remark for {{LSFailureMode}}
                </span>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" >&times;</span>
        </button>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-11 ml-auto">
                        <div class="form-group mt-4">
                            <textarea class="form-control custom-textarea" [(ngModel)]="Remark" id="message" name="body" rows="12" placeholder="Add Remark Here"></textarea>
                        </div>

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Done</button>
            </div>

        </div>
    </div>
</div>

<div *ngIf="ColoredTreeForUpdate">
    <p-card>
        <h5 style="margin-bottom: 1em;"><b>Your selected {{LSFailureMode}} Tree </b></h5>
        <p-organizationChart id="ScrollUpdateTree" [value]="SavedConsequenceNode" selectionMode="single" styleClass="company">
            <ng-template let-node pTemplate="person">
                <div class="node-header p-corner-top">{{node.label}}</div>
                <div class="node-content">
                    <div>{{node.data.name}}
                    </div>
                </div>
            </ng-template>
            <ng-template let-node pTemplate="department">
                {{node.label}}
            </ng-template>
        </p-organizationChart>
        <button [disabled]="UpdateColorTreeEnable" type="button" data-toggle="modal" data-target="#ChangeConsequence" class="btn btn-primary">Update</button>
    </p-card>
</div><br>



<div id="ScrollUpdateTree4" *ngIf="Consequences1" class="col-md-12 stepsdemo-content shadow">
    <p-card>
        <ng-template pTemplate="title">
            Consequences for {{LSFailureMode}}
        </ng-template>
        <ng-template pTemplate="subtitle">
            Choose your Consequences
        </ng-template>
        <ng-template pTemplate="content">
            <div class="p-fluid p-formgrid p-grid">
                <div style="margin-left: 20px;" class="p-fluid">
                    <p> Will the Occurrence of the failure mode ( on its own) be evident to operational staff during normal operation of the plant?</p>
                </div>
                <div class="container">
                    <div *ngFor="let con1 of draggedConsequencesYesNO" class="border" pDraggable="con1" (onDragStart)="dragStartC1($event,con1)" (onDragEnd)="dragEndC1($event)">
                        {{con1}}
                    </div>
                    <div class="drop" pDroppable="con1" (onDrop)="dropC1($event)">
                        <div *ngFor="let c of dropedConsequenceFailureMode">{{c}}
                            <a class="cell-icon-button cdk-close" style="float:right;color: black;" (click)="FailureModeDropped(c)" pTooltip="Delete" tooltipPosition="top">
                                <i class="far fa-times-circle "></i>
                            </a>
                        </div>

                    </div>
                    <small class="form-text text-muted">Drag and Drop here, from above List</small> <br>

                </div>

            </div>
        </ng-template>
        <ng-template pTemplate="footer">
            <button label="Next" type="button" class="btn btn-dark" (click)="Consequence1Next()">Next</button>

        </ng-template>
    </p-card>
</div>



<div *ngIf="Consequences2" class="col-md-12 stepsdemo-content shadow">
    <p-card>
        <ng-template pTemplate="title">
            Consequences for {{LSFailureMode}}
        </ng-template>
        <ng-template pTemplate="subtitle">
            Choose your Consequences
        </ng-template>
        <ng-template pTemplate="content">
            <div class="p-fluid p-formgrid p-grid">
                <div style="margin-left: 20px;" class="p-fluid">
                    <p> Does the effect of the failure mode(or the secondary effect resulting from the failuer) have direct adverse effect on operational safety or the environment?</p>
                </div>
                <div class="container">
                    <div *ngFor="let con2 of draggedConsequencesYesNO" class="border" pDraggable="con2" (onDragStart)="dragStartC2($event,con2)" (onDragEnd)="dragEndC2($event)">
                        {{con2}}
                    </div>
                    <div class="drop" pDroppable="con2" (onDrop)="dropC2($event)">
                        <div *ngFor="let c of dropedConsequenceEffectFailureMode">{{c}}
                            <a class="cell-icon-button cdk-close" style="float:right;color: black;" (click)="FailureModeDropped(c)" pTooltip="Delete" tooltipPosition="top">
                                <i class="far fa-times-circle "></i>
                            </a>
                        </div>
                    </div>
                    <small class="form-text text-muted">Drag and Drop here, from above List</small> <br>

                </div>

            </div>
        </ng-template>
        <ng-template pTemplate="footer">
            <button label="Back" type="button" class="btn btn-dark" style="margin-left: 70px" (click)="Consequence2Back()">Back</button>
            <button label="Next" type="button" class="btn btn-dark" style="float: right; margin-right: 70px" (click)="Consequence2Next()">Next</button>

        </ng-template>
    </p-card>
</div>

<div *ngIf="Consequences3" class="col-md-12 stepsdemo-content shadow">
    <p-card>
        <ng-template pTemplate="title">
            Consequences for {{LSFailureMode}}
        </ng-template>
        <ng-template pTemplate="subtitle">
            Choose your Consequences
        </ng-template>
        <ng-template pTemplate="content">
            <div class="p-fluid p-formgrid p-grid">
                <div style="margin-left: 20px;" class="p-fluid">
                    <p>Does the combination of the failure mode and one additonal failure or event result in an adverse effect safety of the environment? </p>
                </div>
                <div class="container">
                    <div *ngFor="let con3 of draggedConsequencesYesNO" class="border" pDraggable="con3" (onDragStart)="dragStartC3($event,con3)" (onDragEnd)="dragEndC3($event)">
                        {{con3}}
                    </div>
                    <div class="drop" pDroppable="con3" (onDrop)="dropC3($event)">
                        <div *ngFor="let c of dropedConsequenceCombinationFailureMode">{{c}}
                            <a class="cell-icon-button cdk-close" style="float:right;color: black;" (click)="FailureModeDropped(c)" pTooltip="Delete" tooltipPosition="top">
                                <i class="far fa-times-circle "></i>
                            </a>
                        </div>
                    </div>
                    <small class="form-text text-muted">Drag and Drop here, from above List </small> <br>
                </div>

            </div>
        </ng-template>
        <ng-template pTemplate="footer">
            <button label="Back" type="button" class="btn btn-dark" style="margin-left: 70px" (click)="Consequence3Back()">Back</button>
            <button label="Next" type="button" class="btn btn-dark" style="float: right; margin-right: 70px" (click)="Consequence3Next()">Next</button>

        </ng-template>
    </p-card>
</div>

<div *ngIf="Consequences4" class="col-md-12 stepsdemo-content shadow">
    <p-card>
        <ng-template pTemplate="title">
            Consequences for {{LSFailureMode}}
        </ng-template>
        <ng-template pTemplate="subtitle">
            Choose your Consequences
        </ng-template>
        <ng-template pTemplate="content">
            <div class="p-fluid p-formgrid p-grid">
                <div style="margin-left: 20px;" class="p-fluid">
                    <p>Does the Failure mode adversily affect operational capabilities of the plant? </p>
                </div>
                <div class="container">
                    <div *ngFor="let con4 of draggedConsequencesYesNO" class="border" pDraggable="con4" (onDragStart)="dragStartC4($event,con4)" (onDragEnd)="dragEndC4($event)">
                        {{con4}}
                    </div>
                    <div class="drop" pDroppable="con4" (onDrop)="dropC4($event)">
                        <div *ngFor="let c of dropedConsequenceAffectFailureMode">{{c}}
                            <a class="cell-icon-button cdk-close" style="float:right;color: black;" (click)="FailureModeDropped(c)" pTooltip="Delete" tooltipPosition="top">
                                <i class="far fa-times-circle "></i>
                            </a>
                        </div>
                    </div>
                    <small class="form-text text-muted">Drag and Drop here, from above List or you can type below</small> <br>

                </div>

            </div>
        </ng-template>
        <ng-template pTemplate="footer">
            <button label="Back" type="button" class="btn btn-dark" style="margin-left: 70px" (click)="Consequence4Back()">Back</button>
            <button label="Next" type="button" class="btn btn-dark" style="float: right; margin-right: 70px" (click)="Consequence4Next()">Next</button>

        </ng-template>
    </p-card>
</div>

<div *ngIf="ConsequencesTree" class="col-md-12 stepsdemo-content shadow">
    <p-card>
        <span *ngIf="ConsequenceTreeADDConsequenceEnable">
            <small class="form-text text-muted"><h4>Your {{LSFailureMode}} Tree</h4></small>
        </span>
        <span *ngIf="ConsequenceTreeEditConsequenceEnable">
            <small class="form-text text-muted"><h4> Your {{LSFailureMode}} Tree </h4></small>
        </span>
        <button label="Back" type="button" class="btn btn-dark" (click)="ConsequenceTreeBack()">Back</button>&nbsp;&nbsp;
        <button *ngIf="ConsequenceTreeADDConsequenceEnable" title="Add Consequences" label="Back" type="button" class="btn btn-dark" style="margin-left: 70px" (click)="ADDConsequenceToTree()"><i class="pi pi-plus"></i> Consequences</button>
        <button *ngIf="ConsequenceTreeEditConsequenceEnable" title="Edit Consequences" label="Back" type="button" class="btn btn-dark" (click)="EditConsequenceToTree()"><i class="pi pi-pencil"></i> Consequences</button><br>
        <p-organizationChart [value]="ConsequenceNode" (onNodeSelect)="onNodeSelect($event)" styleClass="company">
            <ng-template let-node pTemplate="person">
                <div class="node-header p-corner-top">{{node.label}}</div>
                <div class="node-content">
                    <div>{{node.data.name}}</div>
                </div>
            </ng-template>
            <ng-template let-node pTemplate="department">
                {{node.label}}
            </ng-template>
        </p-organizationChart>
    </p-card>
</div>



<div style="overflow:scroll;" class="modal FailureModeUpdate2" id="FailureModeUpdate2" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" (click)="UpdateFM()" pTooltip="Update Failure modes" tooltipPosition="top">Update Failure Mode</h5>
                <button type="button" class="close" data-dismiss="FailureModeUpdate2" aria-label="Close" (click)="CloseFailureModeUpdate()" pTooltip="Add new Failuer Mode" tooltipPosition="top">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                <div class="container-fluid">
                    <form>
                        <div class="form-group">
                            <label for="exampleFormControlInput1">Failure Mode</label>
                            <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="UpdateFailureMode" id="exampleFormControlInput1" disabled><br>
                            <button type="button" class="btn btn-secondary btn-sm" (click)="UpdateFM()" pTooltip="Update Failure modes" tooltipPosition="top">Update Failure Mode</button>
                        </div>
                        <div *ngIf="EditFM" class="form-group">
                            <div *ngFor="let func of failuerMode" class="border" pDraggable="func" (onDragStart)="dragStart1($event,func)" (onDragEnd)="dragEnd1($event)">
                                {{func.Description}}
                            </div>
                            <div class="drop" pDroppable="func" (onDrop)="drop1($event)">
                                <div *ngFor="let c of dropedMode">
                                    <span>{{c?.Description}}</span>
                                    <a class="cell-icon-button cdk-close" style="float:right;color: black;" (click)="FailureModeDropped(c)" pTooltip="Delete" tooltipPosition="top">
                                        <i class="far fa-times-circle fa-2x"></i>
                                    </a>
                                </div>
                            </div>
                            <small class="form-text text-muted">Drag and Drop here, from above List </small>

                            <button type="button" class="btn btn-secondary btn-sm" (click)="CancelFM()">Close</button>
                            <button type="button" class="btn btn-secondary btn-sm" (click)="SaveFMToTreee()">Save</button>

                        </div>

                        <div class="form-group">
                            <label for="exampleFormControlTextarea1">Local Effect</label>
                            <textarea class="form-control custom-textarea" [ngModelOptions]="{standalone: true}" [(ngModel)]="UpdateFailureModeLocalEffect" id="exampleFormControlTextarea1" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="exampleFormControlTextarea2">System Effect</label>
                            <textarea class="form-control custom-textarea" [ngModelOptions]="{standalone: true}" [(ngModel)]="UpdateFailureModeSystemEffect" id="exampleFormControlTextarea2" rows="3"></textarea>
                        </div>
                        <!-- <div>
                            <button label="Next" style="margin: 20px" type="button" class="btn btn-dark"  data-toggle="modal" data-target="#AttachmentModalUpdate"> <i class="fa fa-paperclip" aria-hidden="true" pTooltip="Add Attachments" tooltipPosition="top"></i></button>
                            <button label="Next" style="margin: 20px" type="button" class="btn btn-dark" data-toggle="modal" data-target="#CommentModal"> <i class="fa fa-comment" aria-hidden="true"  pTooltip="Add Remarks" tooltipPosition="top"></i></button>
                        </div> -->
                        <div style="margin-top: 20px;">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="input-group mb-3">
                                        <div class="input-group-prepend">
                                            <span class="input-group-text" id="uploadAttachments">Upload</span>
                                        </div>
                                        <div class="custom-file">
                                            <input type="file" accept="image/x-png,image/jpeg,.pdf," (change)="uploadAttachmentFile($event)" class="custom-file-input" id="uploadAttachments" aria-describedby="uploadAttachments">
                                            <label class="custom-file-label" *ngIf="fileUpload == ''" for="inputGroupFile01">Attachment</label>
                                            <label class="custom-file-label" (change)="onFileChange($event)" *ngIf="AttaRemarks != ''" for="inputGroupFile01">{{AttaRemarks}}
                                             <label class="custom-file-label" *ngIf="fileUpload != ''" for="inputGroupFile01">{{fileUpload}}</label>
                                            </label>
                                        </div>

                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="input-group mb-3">
                                        <textarea class="form-control custom-textarea" [(ngModel)]="Remark" id="message" name="body" rows="3" placeholder="Add Remark Here"></textarea>
                                    </div>

                                </div>
                            </div>
                        </div>


                        <div class="form-group">
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-8">
                                        <h6> Down Time Factor (Range 1 - 10): {{EditDownTimeFactor}}</h6>
                                    </div>
                                    <div Style="margin-top:8px;" class="col-md-3">
                                        <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="EditDownTimeFactor" [min]="1" [max]="10"></p-slider>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-md-8">
                                        <h6> Scrape Factor (Range 1 - 5): {{EditScrapeFactor}}</h6>
                                    </div>
                                    <div Style="margin-top:8px;" class="col-md-3">
                                        <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="EditScrapeFactor" [min]="1" [max]="5"></p-slider>
                                    </div>
                                </div>

                                <br>

                                <div class="row">
                                    <div class="col-md-8">
                                        <h6> Safety Factor (Range 1 - 20): {{EditSafetyFactor}}</h6>
                                    </div>
                                    <div Style="margin-top:8px;" class="col-md-3">
                                        <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="EditSafetyFactor" [min]="1" [max]="20"></p-slider>
                                    </div>
                                </div>

                                <br>
                                <div class="row">
                                    <div class="col-md-8">
                                        <h6>Protection Factor (Range 1 - 10): {{EditProtectionFactor}}</h6>
                                    </div>
                                    <div Style="margin-top:8px;" class="col-md-3">
                                        <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="EditProtectionFactor" [min]="1" [max]="10"></p-slider>
                                    </div>
                                </div>

                                <br>

                                <div class="row">
                                    <div class="col-md-8">
                                        <h6>Frequency Factor (Range 1 - 15): {{EditFrequencyFactor}}</h6>
                                    </div>
                                    <div Style="margin-top:8px;" class="col-md-3">
                                        <p-slider [ngModelOptions]="{standalone: true}" [(ngModel)]="EditFrequencyFactor" [min]="1" [max]="15"></p-slider>
                                    </div>
                                </div>
                                <br>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="exampleFormControlInput2">Consequence</label>
                            <input type="text" class="form-control" [ngModelOptions]="{standalone: true}" [(ngModel)]="UpdateFailureModeConsequence" id="exampleFormControlInput2" disabled><br>
                            <button type="button" class="btn btn-secondary btn-sm" (click)="ReplaceConsequence()">Update Consequence</button>
                        </div>

                    </form>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="FailureModeUpdate2" (click)="CloseFailureModeUpdate()">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="FailureModeUpdate2" (click)="SaveFailureModeUpdate()">Save changes</button>
            </div>
        </div>
    </div>
</div>


<!-- 
<div class="modal fade" id="AttachmentModalUpdate" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-11 ml-auto">
                        <div class="toolbar" role="toolbar">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <span class="input-group-text">Upload</span>
                                </div>
                                <div class="custom-file">
                                    <input [disabled]="AttachmentADD" type="file" accept="image/x-png,image/jpeg,.pdf," (change)="uploadAttachmentFile($event)" class="custom-file-input" id="inputGroupFile01">
                                    <label class="custom-file-label" for="inputGroupFile01">Choose file to update attachment</label>
                                </div>
                            </div>
                        </div>
                        <div style="border-color: black;height: 300px;width: 400px;" class="card">
                            <div class="file"><br>
                                <span *ngIf="(EditdbPathURL == '')">
                                    <p style="margin: 20px; margin-left: 40px;"> No attachment to show</p>
                                </span>
                                <span style="margin: 10px;" *ngIf="extensionPDF">
                                <iframe [src]="EditdbPathURL" width="350" height="250" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" style="border:1px solid #CCC; border-width:1px; margin-bottom:5px;" allowfullscreen> </iframe>
                               <a class="attachment"  data-toggle="modal" data-target="#DeleteFailureModeAttachment"><i class="pi pi-times"></i></a>  
                             </span>
                                <span style="margin: 10px;" *ngIf="extensionImage">
                                <img [src]="EditdbPathURL" width="350" height="250" > 
                             
                               <a class="attachment" (click)="DeleteAttachment()"><i class="pi pi-times"></i></a>  
                             </span>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Done</button>
            </div>

        </div>
    </div>
</div>  -->

<!-- <div class="modal fade" id="CommentModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" >&times;</span>
        </button>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-11 ml-auto">
                        <div class="form-group mt-4">
                            <textarea class="form-control custom-textarea" [(ngModel)]="Remark" id="message" name="body" rows="12" placeholder="Add Remark Here"></textarea>
                        </div>

                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Done</button>
            </div>

        </div>
    </div>
</div>  -->

<div class="modal fade" id="DeleteFailureMode" tabindex="-1" role="dialog" aria-labelledby="DeleteFailureModeTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Warning</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete {{DeleteFMName}}
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="DeleteFailureModeFrommTree()">Delete</button>
            </div>
        </div>
    </div>
</div>




<div class="modal fade" id="DeleteFailureModeAttachment" tabindex="-1" role="dialog" aria-labelledby="DeleteFailureModeAttachmentTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Warning</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete atttachment
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="DeleteAttachment()">Delete</button>
            </div>
        </div>
    </div>
</div>



<div class="modal fade" id="ChangeConsequence" tabindex="-1" role="dialog" aria-labelledby="ChangeConsequence" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Warning</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                Are you sure you want to Change the Consequence
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="ChangeConsequence()">Change</button>
            </div>
        </div>
    </div>
</div>


<div *ngIf="FCAViewEnabled">
    <p-card>
        <a class="cell-icon-button cdk-close" style="float:right;color: black;" (click)="CloseFCAUpdateView()" pTooltip="Close" tooltipPosition="top">
            <i class="far fa-times-circle "></i>
        </a>
        <div class="row">
            <div class="col-md-3"></div>
            <div class="col-md-6">
                <div style="width: 13em;height: 7em; margin-left: 140px;">
                    <canvas id="ViewPattern"></canvas>
                </div>
            </div>
            <div class="col-md-3"></div>
        </div>

        <div class="col-md-12" style="overflow: scroll;">
            <p-organizationChart [value]="FCAView" selectionMode="single" styleClass="company">
                <ng-template let-node pTemplate="person">
                    <div class="node-header p-corner-top">{{node.label}}</div>
                    <a class="editFCA-org-bttn" pTooltip="Select Node To edit" data-toggle="modal" data-target="#UpdatePattern" tooltipPosition="top" *ngIf="node.editFCA !== undefined && node.editFCA" (click)="SelectNodeToEdit(node)" pTooltip="Edit Node" tooltipPosition="top"><i class="pi pi-pencil"></i></a>
                    <div class="node-content">
                        <div>{{node.data.name}}</div>
                    </div>
                </ng-template>
                <ng-template let-node pTemplate="department" id="FCATreeShow">
                    {{node.label}}
                </ng-template>
            </p-organizationChart>
        </div>
        <br><br>


        <div *ngIf="FCAViewTreeEnabled" class="col-md-12" style="overflow: scroll;">
            <label>You Have Selected this path</label>
            <button *ngIf="EnabledPatternUpdate" title="Save Pattern" label="save" type="button" class="btn btn-dark" (click)="SaveUpdatedPattern()">Save & Update</button><br>

            <p-organizationChart [value]="FCAdata1" styleClass="company">
                <ng-template let-node pTemplate="person">
                    <div class="node-header p-corner-top">{{node.label}}</div>
                    <div class="node-content">
                        <div>{{node.data.name}}</div>
                    </div>
                </ng-template>
                <ng-template id="SelectedPath" let-node pTemplate="department">
                    {{node.label}}
                </ng-template>
            </p-organizationChart>
        </div>
    </p-card>
</div>

<div class="modal fade" id="UpdatePattern" tabindex="-1" role="dialog" aria-labelledby="ChangeFCA" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Warning</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
            </div>
            <div class="modal-body">
                Are you sure you want to Change the FCA Pattern
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="UpdatePattern()">Change</button>
            </div>
        </div>
    </div>
</div>

<br><br>
<div *ngIf="FailureModePatternTree" class="col-md-12" style="overflow: scroll;">
    <!-- <label class="form-text text-muted">Add FCA for {{PatternFMName}}</label> -->
    <p-organizationChart [value]="FCAChangeData" selectionMode="single" [(selection)]="selectedNode" (onNodeSelect)="onNodeSelect($event)" styleClass="company">
        <ng-template let-node pTemplate="person">
            <div class="node-header p-corner-top">{{node.label}}</div>
            <div class="node-content">
                <div>{{node.data.name}}</div>
            </div>
        </ng-template>
        <ng-template let-node pTemplate="department">
            {{node.label}}
        </ng-template>
    </p-organizationChart>

    <p-card>
        <ng-template pTemplate="title">
            Pattern For Failure Mode
        </ng-template>
        <ng-template pTemplate="subtitle">
            Enter Pattern for {{PatternFMName}}
        </ng-template>
        <ng-template pTemplate="content">
            <div class="p-fluid">
                <div class="row">
                    <div class="row col-md-12">
                        <div class="col-md-2">
                            <div class="col-md-12" style="width: 13em;height: 7em;" (click)="SelectPatternForFailureMode('Pattern 1')">
                                <canvas id="pattern1"></canvas>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12" style="width: 13em;height: 7em;" (click)="SelectPatternForFailureMode('Pattern 2')">
                                <canvas id="pattern2"></canvas>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12" style="width: 13em;height: 7em;" (click)="SelectPatternForFailureMode('Pattern 3')">
                                <canvas id="pattern3"></canvas>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12" style="width: 13em;height: 7em;" (click)="SelectPatternForFailureMode('Pattern 4')">
                                <canvas id="pattern4"></canvas>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12" style="width: 13em;height: 7em;" (click)="SelectPatternForFailureMode('Pattern 5')">
                                <canvas id="pattern5"></canvas>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="col-md-12" style="width: 13em;height: 7em;" (click)="SelectPatternForFailureMode('Pattern 6')">
                                <canvas id="pattern6"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="PatternPathEnable" class="custom-control custom-radio" style="margin:20px;">
                    <input type="radio" [(ngModel)]="PatternPath" id="customRadio1" value="1" name="customRadio" class="custom-control-input">
                    <label class="custom-control-label" for="customRadio1">Select Path</label>
                    <a class="cell-icon-button cdk-close" style="margin-left:25px; color:rgb(245, 148, 172);">
                        <i class="fas fa-circle"></i>
                    </a>
                </div>
                <div *ngIf="PatternPathEnable" class="custom-control custom-radio" style="margin:20px;">
                    <input type="radio" [(ngModel)]="PatternPath" value="2" id="customRadio2" name="customRadio" class="custom-control-input">
                    <label class="custom-control-label" for="customRadio2">Select Path</label>
                    <a class="cell-icon-button cdk-close" style="margin-left:25px; color:rgb(212, 218, 211);" class="fas fa-circle">
                    </a>
                </div>

            </div>
        </ng-template>
        <ng-template pTemplate="footer">
            <div>
                <button *ngIf="UpdatePatternAddEnable" label="Next" style="float: right;" (click)="PatternUpdateAdd()" type="button" class="btn btn-dark">ADD</button>
                <button *ngIf="AddFMPatternAddEnable" label="Next" style="float: right;" (click)="AddPatternToNewFM()" type="button" class="btn btn-dark">ADD Pattern</button>
            </div>
        </ng-template>
    </p-card>

</div>